# 左值与右值

**左值**

左值表示一个占据内存中可识别位置的一个对象，更进一步地，可以对左值取地址

```C++
int a = 10;
int *p = &a;
int **q = &p;
```

a,p,q都是很经典的左值，可以通过标识符a,p,q，取出内存地址中对应的对象

```C++
int a;// ①
a = 4;// ②
```

  


**右值**

判断右值的一个简单方法就是能不能对变量或者表达式取地址，如果不能，他就是右值

```C++
int foo{return 10;};
x+1;
```

函数返回的对象（非引用，非指针）是一种典型的右值，这些对象在函数返回之后会被立刻销毁，也就不存在说取地址这样的操作了。如foo() = 20是一个典型的错误
加减乘除等表达式也是右值，因为x+1的结果保存在临时寄存器中，并不会输出到内存，因为没有办法对这个结果取地址，因为它们也是左值

```c++
a+1 = 4;
foo() = 10;
```

a+1以及foo()返回的值均为右值，它们都是一个临时的值，在表达式结束时，生命周期结束  


**左值和右值的转换**

* **左值和右值在不同的表达式中有不同的定义**

  ```C++
  int a = 10,b = 20;
  int c = a + b;
  ```

  在第一行中，a,b都是左值，但在第二行中，由于要执行加法，所以会将左值隐式地转换成右值，其结果也是一个右值，保存在临时寄存器中，而后写入c的内存中

* **解引用操作符*（作用于右值，返回左值）**
  解引用操作符作用于指针，取出指针指向的内存内容，该结果可以作为左值使用

  ```c++
  int *p = &a;
  *(p+1) = 20;
  ```

  p+1的结果是一个右值，但是*(p+1)的结果是左值

* **取地址操作符&（作用于左值，返回右值）**
  取地址操作符& 一定是作用在左值上，这也是前面定义左值使用的方式

  ```c++
  int a[] = {1,2,3};
  int *p = &a[2];
  int *q = &(a+1);//error 
  ```

  

