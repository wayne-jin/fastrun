# 函数调用过程

* 参数入栈：将函数的参数从右向左依次压入系统栈中
* 返回地址入栈：将当前代码区调用指令的下一条指令地址压入栈中，供函数返回时继续执行
* 代码区跳转：处理器从当前代码区跳转到被调用函数的入口处
* 栈帧调整：
  * 保存当前栈帧状态值，已备后面恢复本栈帧时使用（EBP入栈）
  * 将当前栈帧切换到新栈帧。（将ESP值装入EBP，更新栈帧底部）
  * 给新栈帧分配空间。（把ESP减去所需空间的大小，抬高栈顶）

假设代码运行的顺序为mian函数调用fun_A，然后fun_A调用fun_B，为了方便理解栈帧变化状态，在下图中的栈底位于最下方。

​        ![img](https://img-blog.csdn.net/20180507203020279)

在main函数调用func_A的时候，首先在自己的栈帧中压入函数返回地址，然后为func_A创建新栈帧并压入系统栈在func_A
调用func_B的时候，同样先在自己的栈帧中压入函数返回地址，然后为func_B创建新栈帧并压入系统栈
在func_B返回时，func_B的栈帧被弹出系统栈，func_A栈帧中的返回地址被“露”在栈顶，此时处理器按照这个返回地址重新跳到func_A代码区中执行
在func_A返回时，func_A的栈帧被弹出系统栈，main函数栈帧中的返回地址被“露”在栈顶，此时处理器按照这个返回地址跳到main函数代码区中执行

