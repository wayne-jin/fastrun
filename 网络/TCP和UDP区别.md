# TCP和UDP区别

### TCP和UDP区别

* TCP 是面向连接的（三次握手建立连接），UDP 是无连接的即发送数据前不需要先建立链接
* TCP 提供可靠的服务。也就是说，通过 TCP 连接传送的数据，无差错，不丢失，不重复，且按序到达;UDP 尽最大努力交付，不保证可靠交付。 （并且因为 TCP 可靠，面向连接，不会丢失数据因此适合大数据量的交换）
* TCP 是面向字节流，UDP 面向报文，并且网络出现拥塞不会使得发送速率降低（因此会出现丢包，对实时的应用比如 IP 电话和视频会议等）。
* TCP 只能是 1 对 1 的，UDP 支持 1 对 1,1 对多
* TCP 的首部较大为 20 字节，而 UDP 只有 8 字节
* TCP 是面向连接的可靠性传输，而 UDP 是不可靠的  
  





### TCP和UDP在游戏中适用场景

在实时性方面，tcp协议的网络抗性欠佳，对MOBA类或其他实时性要求较高的游戏，一般是不建议使用tcp作为协议载体。事实上，王者荣耀的PVP通信协议也确实是基于udp封装的；同样，最近大家喜闻乐见的《绝地求生》，也是基于udp的。

不同类型的游戏因为玩法、竞技程度不一样，采用的同步算法不一样，对网络延迟的要求也不一样。例如，MOBA类游戏多使用帧同步为主要同步算法，竞技性也较高，无论从流畅性，还是从公平性要求来说，对响应延迟的要求都最高，根据业内经验，当客户端与服务器的网络延迟超过150ms时，会开始出现卡顿，当延迟超过250ms时，会对玩家操作造成较大影响，游戏无法公平进行。类似地，“吃鸡”游戏（如《绝地求生》）玩法对玩家坐标、动作的同步要求极高，延迟稍大导致的数据不一致对体验都会造成较大影响，其实时性要求接近MOBA类游戏。而对于传统mmorpg来说，多采用状态同步算法，以属性养成和装备获取为关注点，也有一定竞技性，出于对游戏流畅性的要求，对延迟也有一定要求，同步算法的优化程度不一样，这一要求也不一样，一般情况下为保证游戏正常进行，需要响应延迟保持在300ms以下。相比之下，对于炉石传说、斗地主、梦幻西游等回合制游戏来说，同时只有一个玩家在操作双方数据，无数据竞争，且时间粒度较粗，甚至可通过特效掩盖延迟，因此对网络延迟的要求不高，即便延迟达到500ms~1000ms，游戏也能正常进行。

一般游戏中TCP和UDP会同时用的，如果对于数据传输速度要求非常高的场景，比如FPS，MOBA等游戏过程中，用户对战时候的数据肯定是要用UDP来传输的，并且在程序层面保证传输的可靠性，包括自己做校验等；但其它模块，比如大厅里啊，买东西啊，创建房间啊等等，都是可以TCP实现的。魔兽世界用TCP是因为他对数据的即时要求并没有那么高，而且有很多的校验啊，技能读条等等，在副本中晚跑个一秒或者放技能多读一秒，影响并没有那么大，但如果是LOL，那可能团战都要输了。
