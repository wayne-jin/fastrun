# 分布式架构

### 基础分布式架构

* 简单的服务器架构可以只由一个进程组成，所有的逻辑（例如网络连接，游戏逻辑，数据存储等）都在该进程中完成。服务进程使用单线程、无阻塞套接字来服务所有玩家，所有玩家的请求都发到同一个线程去处理
* 然而随着在线人数和游戏数据的增加，这种架构的服务器变得不堪重负，于是把游戏逻辑分离到不同的进程中去。网关部分分离到gateserver，数据存储部分分离到dbserver。把网络功能单独提取出来，让用户统一去连接网关服务器，再由网关服务器转发数据后到后端gameserver。所有与db交互的都发送到dbserver去处理
* 对于游戏逻辑庞大的游戏类型来说，一个gameserver是跟不上的。于是我们可以启动多个gameserver，把玩家分派到不同的gameserver去处理。把全服的逻辑（如公会，全服活动等）分离到中心服centerserver，对于gameserver之间玩家的交互，可以统一连接到centerserver进行交换。类似的，gateway也可以启动多个实例，用来承载更多的在线玩家
* 有了上述的经验，后续肯定是拆分的越细，性能越好，每个相同的模块分布到一台服务器处理，多组服务器集群共同组成一个游戏服务端。一般的，我们可以单独分离出一个聊天服chatserver（聊天）、关系服relationserver（好友、公会）、场景服sceneserver（场景，视野）、场景管理服scenemgr等等。
* 总之，游戏服务器架构不是固定的，应该由游戏类型来决定，适合的才是最好的
